<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>오피스 스케줄러</title>
    <link rel="stylesheet" href="calendar.css">
    <link rel="stylesheet" href="scroll-styles.css">
    <link rel="stylesheet" href="click-styles.css">
    <link rel="stylesheet" href="detail-edit-btn.css">
    <link rel="stylesheet" href="theme-styles.css">
    <link rel="stylesheet" href="advanced-theme-styles.css">
    <link rel="stylesheet" href="excel-export-styles.css">
    <link rel="stylesheet" href="office-schedule-styles.css">
    <link rel="stylesheet" href="cloud-settings-styles.css">
    <link rel="stylesheet" href="menu-improved-styles.css">
    <link rel="stylesheet" href="menu-visibility-fix.css">
    <link rel="stylesheet" href="enhanced-menu-styles.css">
    <link rel="stylesheet" href="hide-bottom-settings.css">
    <link rel="stylesheet" href="menu-button-fix.css">
    <link rel="stylesheet" href="control-buttons-style.css">
    <link rel="stylesheet" href="schedule-bar-buttons.css">
    <link rel="stylesheet" href="modal-close-visual.css">
    <link rel="stylesheet" href="memo-ui-enhanced.css">
    <link rel="stylesheet" href="excel-export-modal-styles.css">
    <link rel="stylesheet" href="unified-menu-styles.css">
    <link rel="stylesheet" href="wide-view-layout.css">
    <link rel="stylesheet" href="memo-modal-improved.css">
    <link rel="stylesheet" href="sticky-note-style.css">
    <link rel="stylesheet" href="advanced-controls-styles.css">
    <link rel="stylesheet" href="improved-memo-modal.css">
    <link rel="stylesheet" href="preview-control-styles.css">
    <link rel="stylesheet" href="modal-drag-styles.css">
</head>
<body>
    <!-- 와이드 뷰 상태 표시 -->
    <div class="wide-view-indicator">
        🔄 와이드 뷰 모드
    </div>
    
    <div class="container">
        <div class="calendar-header">
            <button id="prevBtn">&#8249;</button>
            <div class="date-selector">
                <h1 id="monthYear" class="clickable-title" title="클릭해서 날짜 선택"></h1>
                <div id="dateDropdown" class="date-dropdown" style="display: none;">
                    <div class="date-inputs">
                        <div class="input-group">
                            <label for="yearSelect">년도:</label>
                            <select id="yearSelect"></select>
                        </div>
                        <div class="input-group">
                            <label for="monthSelect">월:</label>
                            <select id="monthSelect">
                                <option value="0">1월</option>
                                <option value="1">2월</option>
                                <option value="2">3월</option>
                                <option value="3">4월</option>
                                <option value="4">5월</option>
                                <option value="5">6월</option>
                                <option value="6">7월</option>
                                <option value="7">8월</option>
                                <option value="8">9월</option>
                                <option value="9">10월</option>
                                <option value="10">11월</option>
                                <option value="11">12월</option>
                            </select>
                        </div>
                    </div>
                    <div class="date-actions">
                        <button id="goToDate" class="go-btn">이동</button>
                        <button id="goToToday" class="today-btn">오늘</button>
                        <button id="cancelDateSelect" class="cancel-btn">취소</button>
                    </div>
                </div>
            </div>
            <button id="nextBtn">&#8250;</button>
            <input type="file" id="fileInput" accept=".json" style="display: none;">
        </div>
        
        <!-- 필터 및 액션 바 -->
        <div class="schedule-add-bar">
            <div class="action-controls">
                <!-- 메뉴 버튼은 unified-menu-final.js에서 동적으로 생성됨 -->
            </div>
            <div class="filter-controls">
                <select id="categoryFilter">
                    <option value="all">모든 카테고리</option>
                    <option value="work">업무</option>
                    <option value="personal">개인</option>
                    <option value="meeting">회의</option>
                    <option value="deadline">마감일</option>
                </select>
            </div>
        </div>
        
        <div class="calendar office-style">
            <div class="weekdays">
                <div class="weekday sunday">일요일</div>
                <div class="weekday">월요일</div>
                <div class="weekday">화요일</div>
                <div class="weekday">수요일</div>
                <div class="weekday">목요일</div>
                <div class="weekday">금요일</div>
                <div class="weekday saturday">토요일</div>
            </div>
            <div class="days" id="daysContainer"></div>
        </div>
        
        <div id="memoModal" class="modal">
            <div class="modal-content draggable">
                <span class="close">&times;</span>
                <div class="modal-header">
                    <h3 id="modalDate"></h3>
                    <div class="modal-controls">
                        <button id="backToListBtn" class="back-btn" title="목록으로 돌아가기" style="display: none;">← 목록</button>
                        <button id="modalLockToggle" class="modal-lock-btn locked" title="메모 삭제 잠김 (클릭해서 해제)">
                            <span class="modal-lock-icon">🔒</span>
                        </button>
                    </div>
                </div>
                <!-- 메모 작성 폼 (항상 상단에 표시) -->
                <div class="add-memo-section-fixed">
                    <div class="form-group">
                        <input type="text" id="newMemoTitle" placeholder="📝 메모 제목을 입력하세요" maxlength="50">
                    </div>
                    <div class="form-group">
                        <textarea id="newMemoContent" placeholder="✍️ 메모 내용을 입력하세요..." rows="3"></textarea>
                    </div>
                    <div class="form-actions">
                        <button id="saveNewMemoBtn" class="save-btn">💾 저장</button>
                        <button id="clearMemoFormBtn" class="cancel-btn">🗑️ 지우기</button>
                    </div>
                </div>
                
                <!-- 메모 리스트 (리스트 형식으로만 표시) -->
                <div class="memo-list-section">
                    <div class="memo-list-header">
                        <h4>📋 저장된 메모</h4>
                        <span id="memoCount" class="memo-count">0개</span>
                    </div>
                    <div id="memoList" class="memo-list-container"></div>
                </div>
            </div>
        </div>
        
        <div id="confirmDialog" class="confirm-dialog" style="display: none !important;">
            <div class="confirm-content">
                <div class="confirm-title">메모 삭제</div>
                <div class="confirm-message">정말로 이 메모를 삭제하시겠습니까?</div>
                <div class="confirm-buttons">
                    <button id="confirmDeleteBtn" class="confirm-btn">삭제</button>
                    <button id="cancelDeleteBtn" class="cancel-btn">취소</button>
                </div>
            </div>
        </div>

        <!-- 테마 설정 모달 -->
        <div id="themeModal" class="modal">
            <div class="modal-content draggable">
                <span class="close" id="themeClose">&times;</span>
                <div class="modal-header">
                    <h3>🎨 테마 설정</h3>
                </div>
                <div class="theme-settings">
                    <div class="theme-group">
                        <label>페이지 배경색</label>
                        <input type="color" id="pageBgColor" value="#667eea">
                    </div>
                    <div class="theme-group">
                        <label>달력 배경색</label>
                        <input type="color" id="calendarBgColor" value="#ffffff">
                    </div>
                    <div class="theme-group">
                        <label>오늘 날짜 색상</label>
                        <input type="color" id="todayBgColor" value="#f5f5f5">
                    </div>
                    <div class="theme-group">
                        <label>메모 배경색</label>
                        <input type="color" id="memoBgColor" value="#f0f8ff">
                    </div>
                    <div class="theme-actions">
                        <button id="saveThemeBtn" class="save-btn">저장</button>
                        <button id="resetThemeBtn" class="cancel-btn">초기화</button>
                    </div>
                </div>
            </div>
        </div>
        
        
        
        <div id="backupMenuModal" class="modal">
            <div class="modal-content backup-menu-content draggable medium">
                <span class="close" id="backupMenuClose">&times;</span>
                <div class="modal-header">
                    <h3>백업 관리</h3>
                </div>
                <div class="backup-menu-tabs">
                    <button id="manualBackupTab" class="tab-btn active">수동 백업</button>
                    <button id="autoBackupTab" class="tab-btn">자동 백업</button>
                    <button id="backupStatsTab" class="tab-btn">백업 정보</button>
                </div>
                
                <div id="manualBackupContent" class="tab-content active">
                    <div class="backup-actions">
                        <div class="action-group">
                            <h4>📤 완전 백업 생성 (3.0 버전)</h4>
                            <button id="createBackupBtn" class="action-btn primary">💾 완전 백업 파일 생성</button>
                            <button id="simpleBackupBtn" class="action-btn secondary" style="margin-top: 8px;">📥 간편 백업 (저장위치 선택)</button>
                            <div class="backup-method-info">
                                <small id="backupMethodText">
                                🆕 <strong>완전 백업 시스템:</strong><br>
                                📝 <strong>메모 데이터:</strong> 모든 날짜의 메모 내용 포함<br>
                                📅 <strong>스케줄 데이터:</strong> 일정, 카테고리, 우선순위 모두 포함<br>
                                🎨 <strong>테마 설정:</strong> 색상, 배경 등 개인화 설정<br>
                                📐 <strong>레이아웃 설정:</strong> 크기, 폰트 등 화면 설정<br>
                                ⚙️ <strong>백업 설정:</strong> 자동 백업 등 앱 설정<br>
                                ✨ <strong>완벽 이동:</strong> 다른 PC에서 모든 설정과 데이터 그대로 복원
                                </small>
                                <div style="margin-top: 6px;">
                                    <small>📂 지정된 다운로드 경로: <span id="manualDownloadFolder">(미지정)</span></small>
                                </div>
                            </div>
                        </div>
                        <div class="action-group">
                            <h4>📥 완전 백업 복원</h4>
                            <button id="restoreBackupBtn" class="action-btn secondary">백업에서 완전 복원</button>
                            <small>
                                메모, 스케줄, 테마, 레이아웃 설정을 모두 복원<br>
                                <strong>🔄 3.0 버전:</strong> 완전 백업 지원<br>
                                <strong>🔙 호환성:</strong> 기존 백업 파일도 지원
                            </small>
                        </div>
                    </div>
                </div>

                <div id="autoBackupContent" class="tab-content">
                    <div class="auto-backup-info">
                        <div class="info-group">
                            <h4>🔄 자동 백업 상태 (간소화 모드)</h4>
                            <div id="autoBackupStatus" class="status-display">
                                <span id="autoBackupStatusText">localStorage 백업 활성화됨</span>
                                <span id="autoBackupInterval">30분마다</span>
                            </div>
                            <small id="lastAutoBackup">브라우저 내부에 자동으로 저장됩니다</small>
                            <div id="backupServerStatus" class="server-status" style="margin-top:8px;">
                                <span id="serverStatusText">서버 상태 확인 중...</span>
                            </div>
                            <small id="serverPathDisplay" style="display:block;color:#666;margin-top:4px;">서버 경로: (확인 중)</small>
                        </div>
                        
                        <!-- 설정 통합: 자동 백업 설정을 이곳에서 직접 수정 -->
                        <div class="info-group">
                            <h4>⚙️ 자동 백업 설정</h4>
                            <div class="settings-summary">
                                <label style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
                                    <input type="checkbox" id="autoBackupEnabled" checked>
                                    자동 백업 사용
                                </label>
                                <label style="display:flex;align-items:center;justify-content:space-between;margin:8px 0;gap:12px;">
                                    <span>자동 백업 주기 (분)</span>
                                    <input type="number" id="backupInterval" value="30" min="5" max="120" style="width:90px;">
                                </label>
                                <label style="display:flex;align-items:center;justify-content:space-between;margin:8px 0;gap:12px;">
                                    <span>최대 보관 파일 수</span>
                                    <input type="number" id="maxBackupFiles" value="10" min="3" max="50" style="width:90px;">
                                </label>
                                <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:10px;">
                                    <button id="saveAutoSettingsBtn" class="action-btn primary">저장</button>
                                    <button id="resetAutoSettingsBtn" class="action-btn secondary">기본값</button>
                                </div>
                            </div>
                        </div>

                        <div class="info-group">
                            <h4>🆕 완전 자동 백업 시스템 (3.0)</h4>
                            <div class="backup-method-info">
                                <small>
                                ✨ <strong>완전 데이터:</strong> 메모, 스케줄, 테마, 레이아웃 설정 모두 포함<br>
                                💾 <strong>이중 백업:</strong> 브라우저 내부 + 선택한 폴더에 동시 저장<br>
                                🔄 <strong>실시간 백업:</strong> 데이터 변경 시 즉시 백업 + 30분마다 정기 백업<br>
                                📁 <strong>폴더 자동 저장:</strong> 백업 메뉴의 "폴더 바로 선택"에서 지정 시 자동 파일 생성<br>
                                🛡️ <strong>다층 보안:</strong> localStorage + 안전 백업 + 응급 백업<br>
                                🚀 <strong>완벽 이동:</strong> 새 PC에서 모든 설정과 데이터 그대로 복원<br>
                                📊 <strong>통계 포함:</strong> 백업 파일에 데이터 통계 정보 포함
                                </small>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="backupStatsContent" class="tab-content">
                    <div class="backup-statistics">
                        <div class="stat-group">
                            <h4>📊 백업 통계</h4>
                            <div class="stats-grid">
                                <div class="stat-item">
                                    <span class="stat-label">총 백업 파일</span>
                                    <span id="totalBackupFiles" class="stat-value">0</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">자동 백업 파일</span>
                                    <span id="autoBackupFiles" class="stat-value">0</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">수동 백업 파일</span>
                                    <span id="manualBackupFiles" class="stat-value">0</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">총 메모 수</span>
                                    <span id="totalMemoCount" class="stat-value">0</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stat-group">
                            <h4>📄 백업 상태</h4>
                            <div class="settings-summary">
                                <p><strong>백업 폴더:</strong> <span id="currentBackupFolder">기본값</span></p>
                                <p><strong>자동 백업 경로:</strong> <span id="autoBackupPath">확인 중...</span></p>
                                <p><strong>자동 백업:</strong> <span id="autoBackupEnabledStatus">활성화</span></p>
                                <p><strong>백업 주기:</strong> <span id="backupIntervalStatus">30분</span></p>
                                <p><strong>최대 파일 수:</strong> <span id="maxBackupFilesStatus">10개</span></p>
                                <p><strong>마지막 백업:</strong> <span id="lastBackupTime">아직 없음</span></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="editMemoModal" class="modal">
            <div class="modal-content draggable">
                <span class="close" id="editMemoClose">&times;</span>
                <div class="modal-header">
                    <h3>메모 수정</h3>
                </div>
                <div class="edit-memo-form">
                    <div class="form-group">
                        <label for="editMemoTitle">제목:</label>
                        <input type="text" id="editMemoTitle" placeholder="메모 제목을 입력하세요">
                    </div>
                    <div class="form-group">
                        <label for="editMemoContent">내용:</label>
                        <textarea id="editMemoContent" rows="8" placeholder="메모 내용을 입력하세요"></textarea>
                    </div>
                    <div class="form-actions">
                        <button id="saveMemoBtn" class="save-btn">저장</button>
                        <button id="cancelEditBtn" class="cancel-btn">취소</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="themeModal" class="modal">
            <div class="modal-content draggable medium">
                <span class="close" id="themeClose">&times;</span>
                <div class="modal-header">
                    <h3>테마 설정</h3>
                </div>
                <div class="theme-tabs">
                    <button id="basicThemeTab" class="theme-tab-btn active">기본 색상</button>
                    <button id="advancedThemeTab" class="theme-tab-btn">고급 설정</button>
                    <button id="presetsThemeTab" class="theme-tab-btn">프리셋</button>
                </div>
                <div class="theme-content" id="basicThemeContent">
                    <!-- 미리보기 제어 섹션 -->
                    <div class="theme-group preview-control-section">
                        <h4>🔍 실시간 미리보기</h4>
                        <div class="preview-controls">
                            <div class="control-item">
                                <label for="themePreviewScale">미리보기 크기:</label>
                                <div class="slider-container">
                                    <input type="range" id="themePreviewScale" min="30" max="100" value="70" step="5">
                                    <span id="themePreviewScaleValue">70%</span>
                                </div>
                            </div>
                            <div class="control-item">
                                <label>
                                    <input type="checkbox" id="enableThemePreview" checked>
                                    실시간 색상 미리보기
                                </label>
                            </div>
                            <div class="control-buttons">
                                <button type="button" id="forceThemePreviewBtn" class="preview-btn primary">
                                    🔍 미리보기 활성화
                                </button>
                                <button type="button" id="disableThemePreviewBtn" class="preview-btn secondary">
                                    ❌ 미리보기 해제
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="theme-group">
                        <label>달력 배경 색상:</label>
                        <div class="color-options color-grid-large">
                            <button class="color-btn" data-bg="linear-gradient(135deg, #667eea 0%, #764ba2 100%)" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)" title="기본 (보라-파랑)"></button>
                            <button class="color-btn" data-bg="linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%)" style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%)" title="빨강"></button>
                            <button class="color-btn" data-bg="linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%)" style="background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%)" title="청록"></button>
                            <button class="color-btn" data-bg="linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%)" style="background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%)" title="황금"></button>
                            <button class="color-btn" data-bg="linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)" style="background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)" title="파랑"></button>
                            <button class="color-btn" data-bg="linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%)" style="background: linear-gradient(135deg, #a29bfe 0%, #6c5ce7 100%)" title="보라"></button>
                            <button class="color-btn" data-bg="linear-gradient(135deg, #ff7675 0%, #d63031 100%)" style="background: linear-gradient(135deg, #ff7675 0%, #d63031 100%)" title="체리"></button>
                            <button class="color-btn" data-bg="linear-gradient(135deg, #00b894 0%, #00a085 100%)" style="background: linear-gradient(135deg, #00b894 0%, #00a085 100%)" title="에메랄드"></button>
                            <button class="color-btn" data-bg="linear-gradient(135deg, #fdcb6e 0%, #e17055 100%)" style="background: linear-gradient(135deg, #fdcb6e 0%, #e17055 100%)" title="오렌지"></button>
                            <button class="color-btn" data-bg="linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%)" style="background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%)" title="라벤더"></button>
                            <button class="color-btn" data-bg="linear-gradient(135deg, #fd79a8 0%, #e84393 100%)" style="background: linear-gradient(135deg, #fd79a8 0%, #e84393 100%)" title="핑크"></button>
                            <button class="color-btn" data-bg="linear-gradient(135deg, #55a3ff 0%, #003d82 100%)" style="background: linear-gradient(135deg, #55a3ff 0%, #003d82 100%)" title="딥블루"></button>
                            <button class="color-btn" data-bg="linear-gradient(135deg, #00cec9 0%, #55efc4 100%)" style="background: linear-gradient(135deg, #00cec9 0%, #55efc4 100%)" title="민트그린"></button>
                            <button class="color-btn" data-bg="linear-gradient(135deg, #ff6348 0%, #ff4757 100%)" style="background: linear-gradient(135deg, #ff6348 0%, #ff4757 100%)" title="코랄"></button>
                            <button class="color-btn" data-bg="linear-gradient(135deg, #5f27cd 0%, #341f97 100%)" style="background: linear-gradient(135deg, #5f27cd 0%, #341f97 100%)" title="다크퍼플"></button>
                        </div>
                    </div>
                    
                    <div class="theme-group">
                        <label>오늘 날짜 색상:</label>
                        <div class="color-options color-grid-medium">
                            <button class="today-color-btn" data-today="#f5f5f5" style="background: #f5f5f5; border: 1px solid #ccc" title="기본 (회색)"></button>
                            <button class="today-color-btn" data-today="#ffecec" style="background: #ffecec" title="연분홍"></button>
                            <button class="today-color-btn" data-today="#e8f4ff" style="background: #e8f4ff" title="연하늘"></button>
                            <button class="today-color-btn" data-today="#f0fff0" style="background: #f0fff0" title="연초록"></button>
                            <button class="today-color-btn" data-today="#fff8dc" style="background: #fff8dc" title="연노랑"></button>
                            <button class="today-color-btn" data-today="#f0f8ff" style="background: #f0f8ff" title="앨리스블루"></button>
                            <button class="today-color-btn" data-today="#fdf2e9" style="background: #fdf2e9" title="연복숭아"></button>
                            <button class="today-color-btn" data-today="#e8f5e8" style="background: #e8f5e8" title="연연두"></button>
                            <button class="today-color-btn" data-today="#f3e5f5" style="background: #f3e5f5" title="연보라"></button>
                            <button class="today-color-btn" data-today="#e1f5fe" style="background: #e1f5fe" title="연시안"></button>
                            <button class="today-color-btn" data-today="#fff3e0" style="background: #fff3e0" title="연오렌지"></button>
                            <button class="today-color-btn" data-today="#fce4ec" style="background: #fce4ec" title="연마젠타"></button>
                        </div>
                    </div>
                    
                    <div class="theme-group">
                        <label>메모가 있는 날짜 색상:</label>
                        <div class="color-options color-grid-medium">
                            <button class="memo-color-btn" data-memo="#f0f8ff" style="background: #f0f8ff" title="기본 (연파랑)"></button>
                            <button class="memo-color-btn" data-memo="#fff0f5" style="background: #fff0f5" title="라벤더"></button>
                            <button class="memo-color-btn" data-memo="#f0fff0" style="background: #f0fff0" title="민트"></button>
                            <button class="memo-color-btn" data-memo="#fff8dc" style="background: #fff8dc" title="크림"></button>
                            <button class="memo-color-btn" data-memo="#ffefd5" style="background: #ffefd5" title="복숭아"></button>
                            <button class="memo-color-btn" data-memo="#e6e6fa" style="background: #e6e6fa" title="라일락"></button>
                            <button class="memo-color-btn" data-memo="#ffe4e1" style="background: #ffe4e1" title="연로즈"></button>
                            <button class="memo-color-btn" data-memo="#e0ffe0" style="background: #e0ffe0" title="연라임"></button>
                            <button class="memo-color-btn" data-memo="#fffacd" style="background: #fffacd" title="레몬"></button>
                            <button class="memo-color-btn" data-memo="#f5f5dc" style="background: #f5f5dc" title="베이지"></button>
                            <button class="memo-color-btn" data-memo="#e6f3ff" style="background: #e6f3ff" title="스카이"></button>
                            <button class="memo-color-btn" data-memo="#fff0e6" style="background: #fff0e6" title="아이보리"></button>
                        </div>
                    </div>
                    
                    <div class="theme-group">
                        <label>페이지 배경 색상 (달력 밖 여백 부분):</label>
                        <div class="color-options color-grid-large">
                            <button class="page-bg-btn" data-page-bg="linear-gradient(135deg, #667eea 0%, #764ba2 100%)" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)" title="기본 (보라-파랑)"></button>
                            <button class="page-bg-btn" data-page-bg="linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%)" style="background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%)" title="빨강"></button>
                            <button class="page-bg-btn" data-page-bg="linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%)" style="background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%)" title="청록"></button>
                            <button class="page-bg-btn" data-page-bg="linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%)" style="background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%)" title="황금"></button>
                            <button class="page-bg-btn" data-page-bg="linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)" style="background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)" title="파랑"></button>
                            <button class="page-bg-btn" data-page-bg="linear-gradient(135deg, #00b894 0%, #00a085 100%)" style="background: linear-gradient(135deg, #00b894 0%, #00a085 100%)" title="에메랄드"></button>
                            <button class="page-bg-btn" data-page-bg="linear-gradient(135deg, #fdcb6e 0%, #e17055 100%)" style="background: linear-gradient(135deg, #fdcb6e 0%, #e17055 100%)" title="오렌지"></button>
                            <button class="page-bg-btn" data-page-bg="linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%)" style="background: linear-gradient(135deg, #6c5ce7 0%, #a29bfe 100%)" title="라벤더"></button>
                            <button class="page-bg-btn" data-page-bg="linear-gradient(135deg, #fd79a8 0%, #e84393 100%)" style="background: linear-gradient(135deg, #fd79a8 0%, #e84393 100%)" title="핑크"></button>
                            <button class="page-bg-btn" data-page-bg="linear-gradient(135deg, #55a3ff 0%, #003d82 100%)" style="background: linear-gradient(135deg, #55a3ff 0%, #003d82 100%)" title="딥블루"></button>
                            <button class="page-bg-btn" data-page-bg="linear-gradient(135deg, #00cec9 0%, #55efc4 100%)" style="background: linear-gradient(135deg, #00cec9 0%, #55efc4 100%)" title="민트그린"></button>
                            <button class="page-bg-btn" data-page-bg="linear-gradient(135deg, #ff6348 0%, #ff4757 100%)" style="background: linear-gradient(135deg, #ff6348 0%, #ff4757 100%)" title="코랄"></button>
                            <button class="page-bg-btn" data-page-bg="linear-gradient(135deg, #5f27cd 0%, #341f97 100%)" style="background: linear-gradient(135deg, #5f27cd 0%, #341f97 100%)" title="다크퍼플"></button>
                            <button class="page-bg-btn" data-page-bg="linear-gradient(135deg, #2d3436 0%, #636e72 100%)" style="background: linear-gradient(135deg, #2d3436 0%, #636e72 100%)" title="다크그레이"></button>
                            <button class="page-bg-btn" data-page-bg="linear-gradient(135deg, #f39c12 0%, #e67e22 100%)" style="background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%)" title="골드"></button>
                        </div>
                    </div>
                    
                    <div class="theme-actions">
                        <button id="resetThemeBtn" class="cancel-btn">기본값 복원</button>
                        <button id="saveThemeBtn" class="save-btn">적용</button>
                    </div>
                </div>
                
                <div class="theme-content" id="advancedThemeContent" style="display: none;">
                    <div class="advanced-section">
                        <h4>🎨 색상 피커</h4>
                        <div class="color-picker-section">
                            <div class="picker-group">
                                <label>대상 선택:</label>
                                <select id="colorTarget">
                                    <option value="calendarBg">달력 배경</option>
                                    <option value="todayBg">오늘 날짜</option>
                                    <option value="memoBg">메모 날짜</option>
                                    <option value="pageBg">페이지 배경</option>
                                </select>
                            </div>
                            <div class="picker-group">
                                <label>색상 타입:</label>
                                <select id="colorType">
                                    <option value="solid">단색</option>
                                    <option value="gradient">그라데이션</option>
                                </select>
                            </div>
                        </div>
                        
                        <div id="solidColorPicker" class="color-picker-container">
                            <label>색상:</label>
                            <input type="color" id="solidColor" value="#667eea">
                            <span id="solidColorHex">#667eea</span>
                        </div>
                        
                        <div id="gradientColorPicker" class="color-picker-container" style="display: none;">
                            <div class="gradient-controls">
                                <div class="gradient-color-group">
                                    <label>시작 색상:</label>
                                    <input type="color" id="gradientColor1" value="#667eea">
                                    <span id="gradientColor1Hex">#667eea</span>
                                </div>
                                <div class="gradient-color-group">
                                    <label>끝 색상:</label>
                                    <input type="color" id="gradientColor2" value="#764ba2">
                                    <span id="gradientColor2Hex">#764ba2</span>
                                </div>
                                <div class="gradient-direction-group">
                                    <label>방향:</label>
                                    <select id="gradientDirection">
                                        <option value="135deg">대각선 ↘</option>
                                        <option value="90deg">세로 ↓</option>
                                        <option value="0deg">가로 →</option>
                                        <option value="45deg">대각선 ↗</option>
                                        <option value="180deg">가로 ←</option>
                                        <option value="270deg">세로 ↑</option>
                                        <option value="225deg">대각선 ↙</option>
                                        <option value="315deg">대각선 ↖</option>
                                    </select>
                                </div>
                            </div>
                            <div class="gradient-preview" id="gradientPreview"></div>
                        </div>
                        
                        <div class="picker-actions">
                            <button id="applyCustomColor" class="save-btn">색상 적용</button>
                            <button id="resetColorPicker" class="cancel-btn">초기화</button>
                        </div>
                    </div>
                    
                    <div class="advanced-section">
                        <h4>🎯 빠른 조합</h4>
                        <div class="quick-combinations">
                            <button class="combo-btn" data-combo="warm">따뜻한 톤</button>
                            <button class="combo-btn" data-combo="cool">차가운 톤</button>
                            <button class="combo-btn" data-combo="pastel">파스텔 톤</button>
                            <button class="combo-btn" data-combo="dark">다크 테마</button>
                            <button class="combo-btn" data-combo="vibrant">생동감 있는</button>
                            <button class="combo-btn" data-combo="monochrome">모노크롬</button>
                        </div>
                    </div>
                    
                    <div class="advanced-section">
                        <h4>💾 사용자 조합</h4>
                        <div class="user-combinations">
                            <div class="save-combination">
                                <input type="text" id="combinationName" placeholder="조합 이름을 입력하세요">
                                <button id="saveCombination" class="save-btn">현재 테마 저장</button>
                            </div>
                            <div class="saved-combinations" id="savedCombinations">
                                <!-- 저장된 조합들이 여기에 표시됩니다 -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="theme-content" id="presetsThemeContent" style="display: none;">
                    <div class="presets-section">
                        <h4>🌈 테마 프리셋</h4>
                        <div class="preset-grid">
                            <div class="preset-item" data-preset="ocean">
                                <div class="preset-preview preset-ocean"></div>
                                <span class="preset-name">바다</span>
                            </div>
                            <div class="preset-item" data-preset="sunset">
                                <div class="preset-preview preset-sunset"></div>
                                <span class="preset-name">석양</span>
                            </div>
                            <div class="preset-item" data-preset="forest">
                                <div class="preset-preview preset-forest"></div>
                                <span class="preset-name">숲</span>
                            </div>
                            <div class="preset-item" data-preset="lavender">
                                <div class="preset-preview preset-lavender"></div>
                                <span class="preset-name">라벤더</span>
                            </div>
                            <div class="preset-item" data-preset="cherry">
                                <div class="preset-preview preset-cherry"></div>
                                <span class="preset-name">벚꽃</span>
                            </div>
                            <div class="preset-item" data-preset="mint">
                                <div class="preset-preview preset-mint"></div>
                                <span class="preset-name">민트</span>
                            </div>
                            <div class="preset-item" data-preset="autumn">
                                <div class="preset-preview preset-autumn"></div>
                                <span class="preset-name">가을</span>
                            </div>
                            <div class="preset-item" data-preset="night">
                                <div class="preset-preview preset-night"></div>
                                <span class="preset-name">밤</span>
                            </div>
                            <div class="preset-item" data-preset="spring">
                                <div class="preset-preview preset-spring"></div>
                                <span class="preset-name">봄</span>
                            </div>
                            <div class="preset-item" data-preset="winter">
                                <div class="preset-preview preset-winter"></div>
                                <span class="preset-name">겨울</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="presets-section">
                        <h4>🎨 랜덤 조합</h4>
                        <div class="random-section">
                            <button id="generateRandom" class="action-btn primary">랜덤 테마 생성</button>
                            <button id="generateHarmony" class="action-btn secondary">조화로운 색상 생성</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="excelExportModal" class="modal">
            <div class="modal-content draggable">
                <span class="close" id="excelExportClose">&times;</span>
                <div class="modal-header">
                    <h3>메모 엑셀 내보내기</h3>
                </div>
                <div class="export-content">
                    <div class="export-options">
                        <div class="option-group">
                            <label>
                                <input type="radio" name="dateOption" value="single" checked>
                                특정 일자
                            </label>
                            <div class="date-input-group">
                                <input type="date" id="singleDate" value="">
                            </div>
                        </div>
                        
                        <div class="option-group">
                            <label>
                                <input type="radio" name="dateOption" value="range">
                                날짜 범위
                            </label>
                            <div class="date-range-group">
                                <input type="date" id="startDate" value="">
                                <span>~</span>
                                <input type="date" id="endDate" value="">
                            </div>
                        </div>
                        
                        <div class="option-group">
                            <label>
                                <input type="radio" name="dateOption" value="month">
                                전체 월
                            </label>
                            <div class="month-input-group">
                                <input type="month" id="monthSelect" value="">
                            </div>
                        </div>
                        
                        <div class="option-group">
                            <label>
                                <input type="radio" name="dateOption" value="all">
                                모든 메모
                            </label>
                        </div>
                    </div>
                    
                    <div class="export-preview">
                        <h4>미리보기</h4>
                        <div id="exportPreview" class="preview-content">
                            날짜를 선택하면 미리보기가 표시됩니다.
                        </div>
                    </div>
                    
                    <div class="export-actions">
                        <button id="previewExportBtn" class="secondary-btn">미리보기 새로고침</button>
                        <button id="executeExportBtn" class="save-btn">엑셀 파일 다운로드</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 스케줄 추가/편집 모달 -->
        <div id="scheduleModal" class="modal">
            <div class="modal-content draggable schedule-modal medium">
                <div class="modal-header">
                    <span class="close" id="scheduleClose">&times;</span>
                    <h3 id="scheduleModalTitle">새 일정 추가</h3>
                    <div class="drag-hint">⋮⋮</div>
                </div>
                <div class="schedule-form">
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="scheduleTitle">일정 제목 *</label>
                            <input type="text" id="scheduleTitle" placeholder="일정 제목을 입력하세요" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="scheduleDate">날짜 *</label>
                            <input type="date" id="scheduleDate" required>
                        </div>
                        <div class="form-group">
                            <label for="scheduleCategory">카테고리</label>
                            <select id="scheduleCategory">
                                <option value="work">업무</option>
                                <option value="personal">개인</option>
                                <option value="meeting">회의</option>
                                <option value="deadline">마감일</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="scheduleStartTime">시작 시간</label>
                            <input type="time" id="scheduleStartTime">
                        </div>
                        <div class="form-group">
                            <label for="scheduleEndTime">종료 시간</label>
                            <input type="time" id="scheduleEndTime">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label>
                                <input type="checkbox" id="scheduleAllDay">
                                종일 일정
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label>
                                <input type="checkbox" id="scheduleNotification" checked>
                                알림 설정
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-row" id="notificationOptions">
                        <div class="form-group">
                            <label for="notificationTime">알림 시기</label>
                            <select id="notificationTime">
                                <option value="0">정시에</option>
                                <option value="5">5분 전</option>
                                <option value="10" selected>10분 전</option>
                                <option value="15">15분 전</option>
                                <option value="30">30분 전</option>
                                <option value="60">1시간 전</option>
                                <option value="1440">1일 전</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="notificationType">알림 방식</label>
                            <select id="notificationType">
                                <option value="browser">브라우저 알림</option>
                                <option value="popup" selected>팝업 알림</option>
                                <option value="both">둘 다</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="scheduleDescription">설명</label>
                            <textarea id="scheduleDescription" rows="3" placeholder="일정에 대한 상세 설명을 입력하세요"></textarea>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group full-width">
                            <label>📎 첨부파일</label>
                            <div class="attachment-section">
                                <input type="file" id="scheduleAttachment" multiple accept="*/*" style="display: none;">
                                <button type="button" id="addAttachmentBtn" class="attachment-btn">
                                    📁 파일 추가
                                </button>
                                <div id="attachmentList" class="attachment-list">
                                    <!-- 첨부파일 리스트가 여기에 표시됩니다 -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="schedulePriority">우선순위</label>
                            <select id="schedulePriority">
                                <option value="low">낮음</option>
                                <option value="medium" selected>보통</option>
                                <option value="high">높음</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="scheduleReminder">알림</label>
                            <select id="scheduleReminder">
                                <option value="none">없음</option>
                                <option value="15min">15분 전</option>
                                <option value="30min">30분 전</option>
                                <option value="1hour">1시간 전</option>
                                <option value="1day">1일 전</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button id="saveScheduleBtn" class="save-btn">저장</button>
                        <button id="deleteScheduleBtn" class="delete-btn" style="display: none;">삭제</button>
                        <button id="cancelScheduleBtn" class="cancel-btn">취소</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 클라우드 설정 모달 -->
        <div id="cloudSettingsModal" class="modal">
            <div class="modal-content draggable medium">
                <span class="close" id="cloudSettingsClose">&times;</span>
                <div class="modal-header cloud-header">
                    <h3>🌥️ 구글 클라우드 동기화 설정</h3>
                    <div class="setup-status">
                        <span id="setupStatusBadge" class="status-badge not-configured">미설정</span>
                    </div>
                </div>
                <div class="cloud-settings-content">
                    <!-- 빠른 시작 섹션 -->
                    <div class="settings-section quick-start">
                        <h4>🚀 빠른 시작 가이드</h4>
                        <div class="quick-start-steps">
                            <div class="step">
                                <span class="step-number">1</span>
                                <div class="step-content">
                                    <strong>Google Cloud Console 열기</strong>
                                    <br><small>API 키와 클라이언트 ID를 생성하세요</small>
                                    <button id="openGoogleConsoleBtn" class="quick-btn">📱 Console 열기</button>
                                </div>
                            </div>
                            <div class="step">
                                <span class="step-number">2</span>
                                <div class="step-content">
                                    <strong>생성한 정보를 아래에 입력</strong>
                                    <br><small>API 키와 OAuth 클라이언트 ID를 입력하세요</small>
                                </div>
                            </div>
                            <div class="step">
                                <span class="step-number">3</span>
                                <div class="step-content">
                                    <strong>테스트 후 저장</strong>
                                    <br><small>연결 테스트로 확인 후 설정을 저장하세요</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="settings-section api-input">
                        <h4>🔧 구글 API 정보 입력</h4>
                        <div class="form-group highlight">
                            <label for="googleClientId">
                                🔐 OAuth 2.0 클라이언트 ID
                                <span class="required">*필수</span>
                            </label>
                            <div class="input-wrapper">
                                <input type="text" id="googleClientId" placeholder="붙여넣기: 123456789-abc...apps.googleusercontent.com" class="settings-input large">
                                <button type="button" id="pasteClientIdBtn" class="paste-btn">📋 붙여넣기</button>
                            </div>
                            <small>📍 Google Cloud Console → 사용자 인증 정보 → OAuth 클라이언트 ID에서 복사</small>
                        </div>
                        
                        <div class="form-group highlight">
                            <label for="googleApiKey">
                                🔑 Google Drive API 키
                                <span class="required">*필수</span>
                            </label>
                            <div class="input-wrapper">
                                <input type="text" id="googleApiKey" placeholder="붙여넣기: AIzaSy..." class="settings-input large">
                                <button type="button" id="pasteApiKeyBtn" class="paste-btn">📋 붙여넣기</button>
                            </div>
                            <small>📍 Google Cloud Console → 사용자 인증 정보 → API 키에서 복사</small>
                        </div>

                        <div class="test-section">
                            <button id="testConnectionBtn" class="test-btn large">🔍 연결 테스트 (먼저 확인해보세요!)</button>
                            <button id="diagnosisBtn" class="secondary-btn" style="width: 100%; margin-top: 8px;">🩺 문제 진단하기</button>
                            <div id="testResult" class="test-result"></div>
                        </div>
                    </div>

                    <div class="settings-section optional-settings" style="display: none;">
                        <h4>⚙️ 추가 설정 (선택사항)</h4>
                        
                        <div class="form-group">
                            <label for="projectName">프로젝트 이름:</label>
                            <input type="text" id="projectName" placeholder="내 달력 앱" class="settings-input">
                            <small>구분을 위한 이름 (Google과는 무관)</small>
                        </div>
                        
                        <div class="form-group">
                            <label for="deviceName">기기 이름:</label>
                            <input type="text" id="deviceName" placeholder="집 컴퓨터" class="settings-input">
                            <small>다른 기기와 구분하기 위한 이름</small>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h4>🔒 보안 설정</h4>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="enableEncryption">
                                데이터 암호화 (선택사항)
                            </label>
                            <small>클라우드에 저장되는 데이터를 암호화합니다</small>
                        </div>
                        
                        <div class="form-group" id="encryptionPasswordGroup" style="display:none;">
                            <label for="encryptionPassword">암호화 비밀번호:</label>
                            <input type="password" id="encryptionPassword" class="settings-input">
                            <small>⚠️ 비밀번호를 잊으면 데이터를 복구할 수 없습니다</small>
                        </div>
                    </div>

                    <div class="sync-controls-main" style="margin: 20px 0; padding: 15px; background: #f8f9ff; border-radius: 8px;">
                        <h4 style="margin: 0 0 10px 0;">🔄 구글 드라이브 동기화</h4>
                        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                            <button id="manualSyncBtn" class="save-btn">🔄 지금 동기화</button>
                            <button id="googleSignInBtn" class="secondary-btn">🔐 구글 로그인</button>
                        </div>
                        <div class="sync-status" id="syncStatus" style="padding: 8px; background: #fff; border-radius: 4px; font-size: 14px; border: 1px solid #ddd;">
                            <strong>동기화 상태:</strong> <span id="syncStatusText">준비됨</span>
                        </div>
                    </div>

                    <div class="settings-actions">
                        <button id="showOptionalSettingsBtn" class="secondary-btn">⚙️ 고급 설정</button>
                        <button id="saveCloudSettingsBtn" class="save-btn big">💾 설정 저장하고 시작하기!</button>
                        <button id="resetCloudSettingsBtn" class="cancel-btn">🔄 모든 설정 초기화</button>
                    </div>

                    <div class="success-section" id="successSection" style="display: none;">
                        <div class="success-message">
                            <h4>🎉 설정이 완료되었습니다!</h4>
                            <p>이제 구글 드라이브와 연동할 수 있습니다.</p>
                            <div class="sync-controls" style="margin: 15px 0;">
                                <button id="manualSyncBtn" class="save-btn" style="margin-right: 10px;">🔄 지금 동기화</button>
                                <button id="googleSignInBtn" class="secondary-btn">🔐 구글 로그인</button>
                            </div>
                            <div class="sync-status" id="syncStatus" style="margin-top: 10px; padding: 10px; background: #f0f8ff; border-radius: 5px; font-size: 14px;">
                                <strong>동기화 상태:</strong> <span id="syncStatusText">준비됨</span>
                            </div>
                        </div>
                    </div>

                    <div class="help-section">
                        <details>
                            <summary>📖 설정 방법 자세히 보기</summary>
                            <div class="help-content">
                                <h5>1. Google Cloud Console 설정</h5>
                                <ol>
                                    <li><a href="https://console.cloud.google.com/" target="_blank">Google Cloud Console</a> 접속</li>
                                    <li>새 프로젝트 생성 또는 기존 프로젝트 선택</li>
                                    <li>"API 및 서비스" > "라이브러리"에서 "Google Drive API" 검색하여 사용 설정</li>
                                    <li>"API 및 서비스" > "사용자 인증 정보" 이동</li>
                                </ol>

                                <h5>2. OAuth 2.0 클라이언트 ID 생성</h5>
                                <ol>
                                    <li>"사용자 인증 정보 만들기" > "OAuth 클라이언트 ID" 선택</li>
                                    <li>애플리케이션 유형: "웹 애플리케이션" 선택</li>
                                    <li>승인된 JavaScript 원본에 추가:
                                        <ul>
                                            <li><code>http://localhost:8000</code></li>
                                            <li><code>file://</code> (파일 직접 실행용)</li>
                                        </ul>
                                    </li>
                                    <li>생성된 클라이언트 ID를 복사하여 위에 입력</li>
                                </ol>

                                <h5>3. API 키 생성</h5>
                                <ol>
                                    <li>"사용자 인증 정보 만들기" > "API 키" 선택</li>
                                    <li>생성된 API 키를 복사하여 위에 입력</li>
                                    <li>(권장) API 키 제한에서 Google Drive API만 허용</li>
                                </ol>

                                <h5>4. 테스트 및 저장</h5>
                                <ol>
                                    <li>"연결 테스트" 버튼으로 설정 확인</li>
                                    <li>테스트 성공 시 "설정 저장" 클릭</li>
                                    <li>구글 드라이브 연동은 클라우드 설정에서 활용 가능</li>
                                </ol>
                            </div>
                        </details>
                    </div>
                </div>
            </div>
        </div>

        <div id="layoutModal" class="modal">
            <div class="modal-content draggable medium">
                <span class="close" id="layoutClose">&times;</span>
                <div class="modal-header">
                    <h3>레이아웃 조절</h3>
                </div>
                <div class="layout-content">
                    <div class="layout-section">
                        <h4>🔍 미리보기 제어</h4>
                        <div class="layout-controls">
                            <div class="control-group">
                                <label for="previewScale">미리보기 화면 크기:</label>
                                <div class="slider-container">
                                    <input type="range" id="previewScale" min="30" max="100" value="80" step="5">
                                    <span id="previewScaleValue">80%</span>
                                </div>
                            </div>
                            
                            <div class="control-group">
                                <label>
                                    <input type="checkbox" id="enablePreviewMode" checked>
                                    실시간 미리보기 모드
                                </label>
                                <small>설정 변경 시 즉시 미리보기에 반영</small>
                            </div>
                            
                            <div class="control-group">
                                <button type="button" id="forcePreviewBtn" class="action-btn primary">
                                    🔍 미리보기 강제 활성화
                                </button>
                                <button type="button" id="disablePreviewBtn" class="action-btn secondary">
                                    ❌ 미리보기 비활성화
                                </button>
                                <small>미리보기가 자동으로 작동하지 않을 때 수동으로 사용</small>
                            </div>
                        </div>
                    </div>
                    
                    <div class="layout-section">
                        <h4>📏 달력 크기 설정</h4>
                        <div class="layout-controls">
                            <div class="control-group">
                                <label for="calendarWidth">달력 폭:</label>
                                <div class="slider-container">
                                    <input type="range" id="calendarWidth" min="400" max="2000" value="1000" step="50">
                                    <span id="widthValue">1000px</span>
                                </div>
                            </div>
                            
                            <div class="control-group">
                                <label for="cellHeight">날짜 셀 높이:</label>
                                <div class="slider-container">
                                    <input type="range" id="cellHeight" min="40" max="200" value="90" step="5">
                                    <span id="heightValue">90px</span>
                                </div>
                            </div>
                            
                            <div class="control-group">
                                <label for="cellGap">날짜 간격:</label>
                                <div class="slider-container">
                                    <input type="range" id="cellGap" min="0" max="30" value="12" step="1">
                                    <span id="gapValue">12px</span>
                                </div>
                            </div>
                            
                            <div class="control-group">
                                <label for="dateFontSize">일자 숫자 크기:</label>
                                <div class="slider-container">
                                    <input type="range" id="dateFontSize" min="8" max="32" value="14" step="1">
                                    <span id="dateFontSizeValue">14px</span>
                                </div>
                            </div>
                            
                            <div class="control-group">
                                <label for="yearFontSize">년도 글자 크기:</label>
                                <div class="slider-container">
                                    <input type="range" id="yearFontSize" min="10" max="48" value="20" step="1">
                                    <span id="yearFontSizeValue">20px</span>
                                </div>
                            </div>
                            
                            <div class="control-group">
                                <label for="holidayFontSize">공휴일 글자 크기:</label>
                                <div class="slider-container">
                                    <input type="range" id="holidayFontSize" min="6" max="24" value="12" step="1">
                                    <span id="holidayFontSizeValue">12px</span>
                                </div>
                            </div>

                            <div class="control-group">
                                <label for="fontFamily">글자 폰트:</label>
                                <div class="slider-container">
                                    <select id="fontFamily" style="width: 100%">
                                        <option value="'Noto Sans KR', 'Segoe UI', Arial, sans-serif">Noto Sans KR</option>
                                        <option value="'Nanum Gothic', 'Malgun Gothic', sans-serif">나눔고딕 / 맑은 고딕</option>
                                        <option value="'Segoe UI', Roboto, Arial, sans-serif">Segoe UI / Roboto</option>
                                        <option value="'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif">Inter (시스템 대체)</option>
                                        <option value="Arial, Helvetica, sans-serif">Arial</option>
                                        <option value="'Times New Roman', Times, serif">Times New Roman</option>
                                        <option value="'Courier New', Courier, monospace">Courier New</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="layout-section">
                        <h4>🖥️ 화면 모드</h4>
                        <div class="screen-mode-controls">
                            <label>
                                <input type="checkbox" id="fullScreenMode">
                                전체 화면 모드 (F11과 유사)
                            </label>
                            <small>브라우저를 전체 화면으로 확장</small>
                            <br><br>
                            <label>
                                <input type="checkbox" id="wideScreenMode">
                                와이드 화면 모드
                            </label>
                            <small>달력을 화면 전체 폭에 맞춤</small>
                            <br><br>
                            <label>
                                <input type="checkbox" id="wideViewMode">
                                와이드 뷰 모드 (NEW!)
                            </label>
                            <small>화면 전체를 활용한 확장된 달력 뷰</small>
                            <br><br>
                            <label>
                                <input type="checkbox" id="maxWidthMode">
                                최대 너비 모드
                            </label>
                            <small>컨테이너 최대 너비 제한 해제</small>
                        </div>
                    </div>
                    
                    <div class="layout-section">
                        <h4>🎯 빠른 설정</h4>
                        <div class="preset-buttons">
                            <button id="miniLayout" class="preset-btn">미니</button>
                            <button id="compactLayout" class="preset-btn">컴팩트</button>
                            <button id="defaultLayout" class="preset-btn">기본</button>
                            <button id="spaciousLayout" class="preset-btn">여유롭게</button>
                            <button id="wideLayout" class="preset-btn">와이드</button>
                            <button id="ultraWideLayout" class="preset-btn">울트라 와이드</button>
                            <button id="extraLargeLayout" class="preset-btn">초대형</button>
                        </div>
                    </div>
                    
                    <div class="layout-section">
                        <h4>📱 반응형 설정</h4>
                        <div class="responsive-controls">
                            <label>
                                <input type="checkbox" id="autoResize" checked>
                                화면 크기에 따라 자동 조정
                            </label>
                            <small>작은 화면에서 자동으로 크기를 조정합니다</small>
                        </div>
                    </div>
                    
                    <div class="layout-actions">
                        <button id="resetLayoutBtn" class="cancel-btn">기본값 복원</button>
                        <button id="saveLayoutBtn" class="save-btn">적용</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Google API 콜백 함수들을 먼저 정의 -->
    <script>
        // Google API 로드 상태 추적
        window.gapiInited = false;
        window.gisInited = false;
        
        function gapiLoaded() {
            window.gapiInited = true;
            console.log('✅ Google API (gapi) loaded');
            if (typeof initializeGoogleAPI === 'function') {
                initializeGoogleAPI();
            }
        }
        
        function gisLoaded() {
            window.gisInited = true;
            console.log('✅ Google Identity Services (gis) loaded');
            if (typeof initializeGoogleAPI === 'function') {
                initializeGoogleAPI();
            }
        }
    </script>
    
    <!-- Google API 스크립트 로드 -->
    <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
    <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
    
    <!-- 오피스 스타일 달력 앱 (모든 기능 작동) -->
    <!-- 완전 통합 버전 (모든 기능 포함) -->
    <script src="calendar-complete.js"></script>
    
    <!-- 테마/레이아웃 메뉴 확장 -->
    <script src="theme-layout-menu.js"></script>
    
    <!-- 고급 컨트롤 모달 -->
    <script src="advanced-controls-modal.js"></script>
    
    <!-- 통합 메모 및 일정 시스템 (충돌 없는 단일 버전) -->
    <script src="unified-calendar-system.js"></script>
    
    <!-- 모달 드래그 시스템 -->
    <script src="modal-drag-system.js"></script>
    
    <!-- 최종 안정화 수정 (메뉴 복구 + 미리보기 + ESC 핸들러) -->
    <script src="final-stable-fix.js"></script>
    
    <!-- 모달 위치 수정 -->
    <script src="modal-position-fix.js"></script>
    
    <!-- 궁극적인 모달 위치 수정 (최종 해결책) -->
    <script src="ultimate-modal-fix.js"></script>
    
    <!-- 스마트 모달 제어 (사용자 의도 구분) -->
    <script src="smart-modal-control.js"></script>
    
    <!-- 간소화된 초기화 (script-loader-clean.js에서 처리) -->
    <script>
    // 사용자 제공 테마 자동 적용
    (function() {
        const userTheme = {
            calendarBg: '#667eea',
            todayBg: '#ffecec', 
            memoBg: '#f0f8ff',
            pageBg: 'linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%)',
            calendarBoxBg: '#ffffff'
        };
        
        const defaultSettings = {
            calendarBg: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
            todayBg: '#f5f5f5',
            memoBg: '#f0f8ff',
            calendarBoxBg: '#ffffff',
            pageBg: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'
        };
        
        const existingTheme = JSON.parse(localStorage.getItem('calendarTheme') || '{}');
        const newTheme = { ...defaultSettings, ...existingTheme, ...userTheme };
        
        localStorage.setItem('calendarTheme', JSON.stringify(newTheme));
        console.log('사용자 테마가 적용되었습니다:', newTheme);
    })();
    </script>
</body>
</html>